<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Assignment Progress Test - Academic OS</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #f8fafc;
        }
        .test-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        .assignment-card {
            border-left: 4px solid #8b5cf6;
            background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
        }
        .metric {
            font-size: 2rem;
            font-weight: bold;
            margin: 10px 0;
        }
        .label {
            color: #6b7280;
            font-size: 0.875rem;
        }
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin: 5px 0;
        }
        .completed { background: #dcfce7; color: #166534; }
        .pending { background: #fef3c7; color: #92400e; }
        .late { background: #fee2e2; color: #991b1b; }
        .button {
            background: #8b5cf6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background: #7c3aed;
        }
        .button:disabled {
            background: #cbd5e1;
            cursor: not-allowed;
        }
        .log {
            background: #1f2937;
            color: #f9fafb;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            max-height: 200px;
            overflow-y: auto;
            margin: 20px 0;
        }
        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e5e7eb;
            border-radius: 6px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #8b5cf6, #7c3aed);
            transition: width 0.5s ease;
        }
        .weight-bar {
            height: 8px;
            background: linear-gradient(90deg, #a78bfa, #8b5cf6);
        }
        .assignment-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .assignment-item {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 15px;
            position: relative;
        }
        .assignment-item.completed {
            border-color: #10b981;
            background: #f0fdf4;
        }
        .assignment-item.pending {
            border-color: #f59e0b;
            background: #fffbeb;
        }
        .assignment-item.late {
            border-color: #ef4444;
            background: #fef2f2;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
    </style>
</head>
<body>
    <h1>📋 Weekly Assignment Progress Component Test</h1>
    
    <div class="test-card">
        <h2>📊 Test Overview</h2>
        <p>This simulation demonstrates the WeeklyAssignmentProgressView component behavior for the current week (Aug 11-17, 2025).</p>
        <div class="stats-grid">
            <div class="stat-item">
                <div class="metric" id="total-count">5</div>
                <div class="label">Total This Week</div>
            </div>
            <div class="stat-item">
                <div class="metric" id="completed-count">2</div>
                <div class="label">Completed</div>
            </div>
            <div class="stat-item">
                <div class="metric" id="pending-count">2</div>
                <div class="label">Pending</div>
            </div>
            <div class="stat-item">
                <div class="metric" id="late-count">1</div>
                <div class="label">Late</div>
            </div>
        </div>
    </div>

    <div class="test-card assignment-card">
        <h3>📈 Assignment Progress Card</h3>
        <div class="metric" id="completion-metric">40%</div>
        <div class="label">Weekly completion status</div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="completion-progress" style="width: 40%"></div>
        </div>
        
        <div style="margin: 15px 0;">
            <div style="display: flex; justify-content: space-between; margin: 8px 0;">
                <span>✅ Completed: <strong id="display-completed">2</strong></span>
                <span>⏳ Pending: <strong id="display-pending">2</strong></span>
                <span>🚨 Late: <strong id="display-late">1</strong></span>
            </div>
        </div>
        
        <div style="border-top: 1px solid #e5e7eb; padding-top: 15px; margin-top: 15px;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                <span class="label">Weight Progress</span>
                <span style="color: #8b5cf6; font-weight: bold;" id="weight-metric">40%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill weight-bar" id="weight-progress" style="width: 40%"></div>
            </div>
            <div style="font-size: 0.75rem; color: #6b7280; margin-top: 5px;" id="weight-detail">
                40.0% of 100.0% total weight
            </div>
        </div>
    </div>

    <div class="test-card">
        <h3>📝 Weekly Assignments</h3>
        <div class="assignment-list" id="assignment-list">
            <!-- Will be populated by JavaScript -->
        </div>
    </div>

    <div class="test-card">
        <h3>🎮 Simulation Controls</h3>
        <button class="button" onclick="gradeAssignment('a3')">💾 Grade Chemistry Assignment (88%)</button>
        <button class="button" onclick="gradeAssignment('a4')">💾 Grade Biology Essay (75%)</button>
        <button class="button" onclick="markLate('a5')">🚨 Mark History Quiz as Completed Late (65%)</button>
        <button class="button" onclick="addNewAssignment()">➕ Add New Assignment</button>
        <button class="button" onclick="resetSimulation()">🔄 Reset</button>
    </div>

    <div class="test-card">
        <h3>📝 Console Logs</h3>
        <div class="log" id="log-output">
            <div>🚀 Weekly Assignment Progress Test Ready</div>
            <div>📊 Current Week: Aug 11-17, 2025</div>
        </div>
    </div>

    <script>
        let assignments = [
            {
                id: 'a1',
                title: 'Math Quiz 1',
                status: 'GRADED',
                score: 85,
                weight: 15,
                dueDate: '2025-08-11T10:00:00Z'
            },
            {
                id: 'a2',
                title: 'Physics Lab Report',
                status: 'GRADED',
                score: 92,
                weight: 25,
                dueDate: '2025-08-13T23:59:00Z'
            },
            {
                id: 'a3',
                title: 'Chemistry Assignment',
                status: 'PENDING',
                score: null,
                weight: 20,
                dueDate: '2025-08-15T18:00:00Z'
            },
            {
                id: 'a4',
                title: 'Biology Essay',
                status: 'DUE',
                score: null,
                weight: 30,
                dueDate: '2025-08-17T23:59:00Z'
            },
            {
                id: 'a5',
                title: 'History Quiz',
                status: 'LATE',
                score: null,
                weight: 10,
                dueDate: '2025-08-12T12:00:00Z'
            }
        ];

        function log(message) {
            const logOutput = document.getElementById('log-output');
            const div = document.createElement('div');
            div.textContent = `${new Date().toLocaleTimeString()} - ${message}`;
            logOutput.appendChild(div);
            logOutput.scrollTop = logOutput.scrollHeight;
        }

        function calculateProgress() {
            const total = assignments.length;
            const completed = assignments.filter(a => a.status === 'GRADED' && a.score !== null).length;
            const pending = assignments.filter(a => ['PENDING', 'DUE'].includes(a.status)).length;
            const late = assignments.filter(a => a.status === 'LATE').length;
            
            const completionRate = total > 0 ? (completed / total) * 100 : 0;
            const totalWeight = assignments.reduce((sum, a) => sum + a.weight, 0);
            const completedWeight = assignments
                .filter(a => a.status === 'GRADED' && a.score !== null)
                .reduce((sum, a) => sum + a.weight, 0);
            const weightProgress = totalWeight > 0 ? (completedWeight / totalWeight) * 100 : 0;

            return {
                total, completed, pending, late,
                completionRate: Math.round(completionRate),
                totalWeight, completedWeight,
                weightProgress: Math.round(weightProgress)
            };
        }

        function updateDisplay() {
            const progress = calculateProgress();
            
            // Update counts
            document.getElementById('total-count').textContent = progress.total;
            document.getElementById('completed-count').textContent = progress.completed;
            document.getElementById('pending-count').textContent = progress.pending;
            document.getElementById('late-count').textContent = progress.late;
            
            // Update progress card
            document.getElementById('completion-metric').textContent = progress.completionRate + '%';
            document.getElementById('completion-progress').style.width = progress.completionRate + '%';
            document.getElementById('display-completed').textContent = progress.completed;
            document.getElementById('display-pending').textContent = progress.pending;
            document.getElementById('display-late').textContent = progress.late;
            
            // Update weight progress
            document.getElementById('weight-metric').textContent = progress.weightProgress + '%';
            document.getElementById('weight-progress').style.width = progress.weightProgress + '%';
            document.getElementById('weight-detail').textContent = 
                `${progress.completedWeight.toFixed(1)}% of ${progress.totalWeight.toFixed(1)}% total weight`;
            
            // Update assignment list
            const listContainer = document.getElementById('assignment-list');
            listContainer.innerHTML = '';
            
            assignments.forEach(assignment => {
                const div = document.createElement('div');
                div.className = `assignment-item ${assignment.status.toLowerCase()}`;
                div.innerHTML = `
                    <h4>${assignment.title}</h4>
                    <div class="badge ${assignment.status.toLowerCase()}">${assignment.status}</div>
                    <div style="margin: 8px 0;">
                        <strong>Weight:</strong> ${assignment.weight}%<br>
                        <strong>Score:</strong> ${assignment.score ? assignment.score + '%' : 'Not graded'}<br>
                        <strong>Due:</strong> ${new Date(assignment.dueDate).toLocaleDateString()}
                    </div>
                `;
                listContainer.appendChild(div);
            });

            // Log the update
            log(`📋 WeeklyAssignmentProgress: Updated - ${progress.completed}/${progress.total} (${progress.completionRate}%) completed, weight: ${progress.weightProgress}%`);
        }

        function gradeAssignment(id) {
            const assignment = assignments.find(a => a.id === id);
            if (!assignment || assignment.status === 'GRADED') return;
            
            const scores = { 'a3': 88, 'a4': 75, 'a5': 65 };
            assignment.score = scores[id];
            assignment.status = 'GRADED';
            
            log(`💾 Assignment saved - refreshing Assignment Progress metrics...`);
            log(`✅ Graded ${assignment.title}: ${assignment.score}%`);
            updateDisplay();
        }

        function markLate(id) {
            const assignment = assignments.find(a => a.id === id);
            if (!assignment) return;
            
            assignment.score = 65;
            assignment.status = 'GRADED';
            
            log(`🚨 Late assignment graded: ${assignment.title} - ${assignment.score}%`);
            updateDisplay();
        }

        function addNewAssignment() {
            const newId = 'a' + (assignments.length + 1);
            const newAssignment = {
                id: newId,
                title: 'New Assignment ' + (assignments.length + 1),
                status: 'PENDING',
                score: null,
                weight: 15,
                dueDate: '2025-08-16T18:00:00Z'
            };
            
            assignments.push(newAssignment);
            log(`➕ Added new assignment: ${newAssignment.title}`);
            updateDisplay();
        }

        function resetSimulation() {
            assignments = [
                {
                    id: 'a1',
                    title: 'Math Quiz 1',
                    status: 'GRADED',
                    score: 85,
                    weight: 15,
                    dueDate: '2025-08-11T10:00:00Z'
                },
                {
                    id: 'a2',
                    title: 'Physics Lab Report',
                    status: 'GRADED',
                    score: 92,
                    weight: 25,
                    dueDate: '2025-08-13T23:59:00Z'
                },
                {
                    id: 'a3',
                    title: 'Chemistry Assignment',
                    status: 'PENDING',
                    score: null,
                    weight: 20,
                    dueDate: '2025-08-15T18:00:00Z'
                },
                {
                    id: 'a4',
                    title: 'Biology Essay',
                    status: 'DUE',
                    score: null,
                    weight: 30,
                    dueDate: '2025-08-17T23:59:00Z'
                },
                {
                    id: 'a5',
                    title: 'History Quiz',
                    status: 'LATE',
                    score: null,
                    weight: 10,
                    dueDate: '2025-08-12T12:00:00Z'
                }
            ];
            
            log('🔄 Reset simulation to initial state');
            updateDisplay();
        }

        // Initialize display
        updateDisplay();
    </script>
</body>
</html>
